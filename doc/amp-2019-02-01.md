Amp 
=========
2019-02-01


Apache Mysql Php on macOs Sierra 10.12.6.

Personal memo.

Note: I just wanted sqlite, but mamp didn't have it, so...


Sources: 
- https://coolestguidesontheplanet.com/get-apache-mysql-php-and-phpmyadmin-working-on-macos-sierra/#disqus_thread
- https://www.dragonbe.com/2017/03/php-7-and-apache-on-macos-sierra.html
- https://htr3n.github.io/2017/09/apache-httpd-php-macos/
- https://help.macstadium.com/articles/how-to-install-apache-mysql-and-php-using-homebrew-on-macos



Obviously, start by turning off Mamp, and roll up your sleeves...


I'm using homebrew.

Note: homebrew's log messages are very precise.
Basically, all the setup I'm using can be done just by typing the following commands and reading the logs:

```bash
brew help
brew search any_package		# gives you the exact name, like THE_PACKAGE for instance
brew install THE_PACKAGE
```








Installing Homebrew
------------------------

```bash
xcode-select --install
```

```bash
/usr/bin/ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
```

```bash
brew config
```


Installing Apache
----------------


```bash
brew search apache 


$ brew install apache2
==> Installing dependencies for httpd: apr, openssl, apr-util, brotli, c-ares, jansson, jemalloc, libev, libevent and nghttp2
==> Installing httpd dependency: apr
==> Downloading https://homebrew.bintray.com/bottles/apr-1.6.5.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring apr-1.6.5.sierra.bottle.tar.gz
==> Caveats
apr is keg-only, which means it was not symlinked into /usr/local,
because Apple's CLT package contains apr.

If you need to have apr first in your PATH run:
  echo 'export PATH="/usr/local/opt/apr/bin:$PATH"' >> ~/.bash_profile

==> Summary
ðŸº  /usr/local/Cellar/apr/1.6.5: 60 files, 1.3MB
==> Installing httpd dependency: openssl
==> Downloading https://homebrew.bintray.com/bottles/openssl-1.0.2q.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring openssl-1.0.2q.sierra.bottle.tar.gz
==> Caveats
A CA file has been bootstrapped using certificates from the SystemRoots
keychain. To add additional certificates (e.g. the certificates added in
the System keychain), place .pem files in
  /usr/local/etc/openssl/certs

and run
  /usr/local/opt/openssl/bin/c_rehash

openssl is keg-only, which means it was not symlinked into /usr/local,
because Apple has deprecated use of OpenSSL in favor of its own TLS and crypto libraries.

If you need to have openssl first in your PATH run:
  echo 'export PATH="/usr/local/opt/openssl/bin:$PATH"' >> ~/.bash_profile

For compilers to find openssl you may need to set:
  export LDFLAGS="-L/usr/local/opt/openssl/lib"
  export CPPFLAGS="-I/usr/local/opt/openssl/include"

For pkg-config to find openssl you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/openssl/lib/pkgconfig"

==> Summary
ðŸº  /usr/local/Cellar/openssl/1.0.2q: 1,794 files, 12.3MB
==> Installing httpd dependency: apr-util
==> Downloading https://homebrew.bintray.com/bottles/apr-util-1.6.1_1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring apr-util-1.6.1_1.sierra.bottle.tar.gz
==> Caveats
apr-util is keg-only, which means it was not symlinked into /usr/local,
because Apple's CLT package contains apr.

If you need to have apr-util first in your PATH run:
  echo 'export PATH="/usr/local/opt/apr-util/bin:$PATH"' >> ~/.bash_profile

==> Summary
ðŸº  /usr/local/Cellar/apr-util/1.6.1_1: 54 files, 778.3KB
==> Installing httpd dependency: brotli
==> Downloading https://homebrew.bintray.com/bottles/brotli-1.0.7.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring brotli-1.0.7.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/brotli/1.0.7: 25 files, 2.2MB
==> Installing httpd dependency: c-ares
==> Downloading https://homebrew.bintray.com/bottles/c-ares-1.15.0.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring c-ares-1.15.0.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/c-ares/1.15.0: 72 files, 483.7KB
==> Installing httpd dependency: jansson
==> Downloading https://homebrew.bintray.com/bottles/jansson-2.12.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring jansson-2.12.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/jansson/2.12: 11 files, 157.9KB
==> Installing httpd dependency: jemalloc
==> Downloading https://homebrew.bintray.com/bottles/jemalloc-5.1.0.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring jemalloc-5.1.0.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/jemalloc/5.1.0: 16 files, 1.7MB
==> Installing httpd dependency: libev
==> Downloading https://homebrew.bintray.com/bottles/libev-4.24.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libev-4.24.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/libev/4.24: 12 files, 432.2KB
==> Installing httpd dependency: libevent
==> Downloading https://homebrew.bintray.com/bottles/libevent-2.1.8.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libevent-2.1.8.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/libevent/2.1.8: 847 files, 2.2MB
==> Installing httpd dependency: nghttp2
==> Downloading https://homebrew.bintray.com/bottles/nghttp2-1.35.1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring nghttp2-1.35.1.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/nghttp2/1.35.1: 26 files, 2.7MB
==> Installing httpd
==> Downloading https://homebrew.bintray.com/bottles/httpd-2.4.37_1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring httpd-2.4.37_1.sierra.bottle.tar.gz
==> Caveats
DocumentRoot is /usr/local/var/www.

The default ports have been set in /usr/local/etc/httpd/httpd.conf to 8080 and in
/usr/local/etc/httpd/extra/httpd-ssl.conf to 8443 so that httpd can run without sudo.

To have launchd start httpd now and restart at login:
  brew services start httpd
Or, if you don't want/need a background service you can just run:
  apachectl start
==> Summary
ðŸº  /usr/local/Cellar/httpd/2.4.37_1: 1,648 files, 26.9MB
==> Caveats
==> apr
apr is keg-only, which means it was not symlinked into /usr/local,
because Apple's CLT package contains apr.

If you need to have apr first in your PATH run:
  echo 'export PATH="/usr/local/opt/apr/bin:$PATH"' >> ~/.bash_profile

==> openssl
A CA file has been bootstrapped using certificates from the SystemRoots
keychain. To add additional certificates (e.g. the certificates added in
the System keychain), place .pem files in
  /usr/local/etc/openssl/certs

and run
  /usr/local/opt/openssl/bin/c_rehash

openssl is keg-only, which means it was not symlinked into /usr/local,
because Apple has deprecated use of OpenSSL in favor of its own TLS and crypto libraries.

If you need to have openssl first in your PATH run:
  echo 'export PATH="/usr/local/opt/openssl/bin:$PATH"' >> ~/.bash_profile

For compilers to find openssl you may need to set:
  export LDFLAGS="-L/usr/local/opt/openssl/lib"
  export CPPFLAGS="-I/usr/local/opt/openssl/include"

For pkg-config to find openssl you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/openssl/lib/pkgconfig"

==> apr-util
apr-util is keg-only, which means it was not symlinked into /usr/local,
because Apple's CLT package contains apr.

If you need to have apr-util first in your PATH run:
  echo 'export PATH="/usr/local/opt/apr-util/bin:$PATH"' >> ~/.bash_profile

==> httpd
DocumentRoot is /usr/local/var/www.

The default ports have been set in /usr/local/etc/httpd/httpd.conf to 8080 and in
/usr/local/etc/httpd/extra/httpd-ssl.conf to 8443 so that httpd can run without sudo.

To have launchd start httpd now and restart at login:
  brew services start httpd
Or, if you don't want/need a background service you can just run:
  apachectl start
$ 

```


### First test with Apache


```bash
$ brew services start httpd
==> Tapping homebrew/services
Cloning into '/usr/local/Homebrew/Library/Taps/homebrew/homebrew-services'...
remote: Enumerating objects: 17, done.
remote: Counting objects: 100% (17/17), done.
remote: Compressing objects: 100% (14/14), done.
remote: Total 17 (delta 0), reused 10 (delta 0), pack-reused 0
Unpacking objects: 100% (17/17), done.
Tapped 1 command (49 files, 59.3KB).
==> Successfully started `httpd` (label: homebrew.mxcl.httpd)
$ ps aux | grep httpd
ling    34136   0.0  0.0  2432804    768 s000  S+    7:57PM   0:00.00 grep httpd
ling    34134   0.0  0.0  2462400    576   ??  S     7:56PM   0:00.00 /usr/local/opt/httpd/bin/httpd -D FOREGROUND
ling    34133   0.0  0.0  2462400    564   ??  S     7:56PM   0:00.00 /usr/local/opt/httpd/bin/httpd -D FOREGROUND
ling    34132   0.0  0.0  2462400    576   ??  S     7:56PM   0:00.00 /usr/local/opt/httpd/bin/httpd -D FOREGROUND
ling    34131   0.0  0.0  2462400    572   ??  S     7:56PM   0:00.00 /usr/local/opt/httpd/bin/httpd -D FOREGROUND
ling    34130   0.0  0.0  2462400    576   ??  S     7:56PM   0:00.00 /usr/local/opt/httpd/bin/httpd -D FOREGROUND
ling    34127   0.0  0.0  2462656   2296   ??  S     7:56PM   0:00.04 /usr/local/opt/httpd/bin/httpd -D FOREGROUND
$ 
```

Testing in a browser:

```txt
http://localhost:8080/
It works!
```



### Apache configuration

```bash
open /usr/local/etc/httpd/httpd.conf
```

```bash
Listen 80
User ling
Group staff
# Virtual hosts
Include /usr/local/etc/httpd/extra/httpd-vhosts.conf
```






Okay, let's add some aliases (in .bash_profile):

```bash
alias apstart='sudo brew services start httpd'
alias aprestart='sudo brew services restart httpd'
alias apstop='sudo brew services stop httpd'
alias apconf='open /usr/local/etc/httpd/httpd.conf'
alias aphost='open /usr/local/etc/httpd/extra/httpd-vhosts.conf'
```





Installing php
-----------------

```bash
brew search php 

brew install php@7.2
==> Installing dependencies for php@7.2: argon2, aspell, autoconf, libidn, libmetalink, libssh2, openldap, rtmpdump, curl-openssl, libtool, unixodbc, freetds, libpng, glib, gmp, icu4c, jpeg, libpq, libsodium, libzip, readline, sqlite, tidy-html5 and webp
==> Installing php@7.2 dependency: argon2
==> Downloading https://homebrew.bintray.com/bottles/argon2-20171227.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring argon2-20171227.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/argon2/20171227: 11 files, 590KB
==> Installing php@7.2 dependency: aspell
==> Downloading https://homebrew.bintray.com/bottles/aspell-0.60.6.1_1.sierra.bottle.1.tar.gz
######################################################################## 100.0%
==> Pouring aspell-0.60.6.1_1.sierra.bottle.1.tar.gz
ðŸº  /usr/local/Cellar/aspell/0.60.6.1_1: 758 files, 314.9MB
==> Installing php@7.2 dependency: autoconf
==> Downloading https://homebrew.bintray.com/bottles/autoconf-2.69.sierra.bottle.4.tar.gz
######################################################################## 100.0%
==> Pouring autoconf-2.69.sierra.bottle.4.tar.gz
==> Caveats
Emacs Lisp files have been installed to:
  /usr/local/share/emacs/site-lisp/autoconf
==> Summary
ðŸº  /usr/local/Cellar/autoconf/2.69: 70 files, 3.0MB
==> Installing php@7.2 dependency: libidn
==> Downloading https://homebrew.bintray.com/bottles/libidn-1.35.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libidn-1.35.sierra.bottle.tar.gz
==> Caveats
Emacs Lisp files have been installed to:
  /usr/local/share/emacs/site-lisp/libidn
==> Summary
ðŸº  /usr/local/Cellar/libidn/1.35: 72 files, 1.4MB
==> Installing php@7.2 dependency: libmetalink
==> Downloading https://homebrew.bintray.com/bottles/libmetalink-0.1.3.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libmetalink-0.1.3.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/libmetalink/0.1.3: 30 files, 178.4KB
==> Installing php@7.2 dependency: libssh2
==> Downloading https://homebrew.bintray.com/bottles/libssh2-1.8.0.sierra.bottle.1.tar.gz
######################################################################## 100.0%
==> Pouring libssh2-1.8.0.sierra.bottle.1.tar.gz
ðŸº  /usr/local/Cellar/libssh2/1.8.0: 182 files, 799KB
==> Installing php@7.2 dependency: openldap
==> Downloading https://homebrew.bintray.com/bottles/openldap-2.4.47.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring openldap-2.4.47.sierra.bottle.tar.gz
==> Caveats
openldap is keg-only, which means it was not symlinked into /usr/local,
because macOS already provides this software and installing another version in
parallel can cause all kinds of trouble.

If you need to have openldap first in your PATH run:
  echo 'export PATH="/usr/local/opt/openldap/bin:$PATH"' >> ~/.bash_profile
  echo 'export PATH="/usr/local/opt/openldap/sbin:$PATH"' >> ~/.bash_profile

For compilers to find openldap you may need to set:
  export LDFLAGS="-L/usr/local/opt/openldap/lib"
  export CPPFLAGS="-I/usr/local/opt/openldap/include"

==> Summary
ðŸº  /usr/local/Cellar/openldap/2.4.47: 327 files, 6.6MB
==> Installing php@7.2 dependency: rtmpdump
==> Downloading https://homebrew.bintray.com/bottles/rtmpdump-2.4+20151223.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring rtmpdump-2.4 20151223.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/rtmpdump/2.4+20151223: 19 files, 422.2KB
==> Installing php@7.2 dependency: curl-openssl
==> Downloading https://homebrew.bintray.com/bottles/curl-openssl-7.63.0_1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring curl-openssl-7.63.0_1.sierra.bottle.tar.gz
==> Caveats
curl-openssl is keg-only, which means it was not symlinked into /usr/local,
because macOS already provides this software and installing another version in
parallel can cause all kinds of trouble.

If you need to have curl-openssl first in your PATH run:
  echo 'export PATH="/usr/local/opt/curl-openssl/bin:$PATH"' >> ~/.bash_profile

For compilers to find curl-openssl you may need to set:
  export LDFLAGS="-L/usr/local/opt/curl-openssl/lib"
  export CPPFLAGS="-I/usr/local/opt/curl-openssl/include"

For pkg-config to find curl-openssl you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/curl-openssl/lib/pkgconfig"

==> Summary
ðŸº  /usr/local/Cellar/curl-openssl/7.63.0_1: 445 files, 3.4MB
==> Installing php@7.2 dependency: libtool
==> Downloading https://homebrew.bintray.com/bottles/libtool-2.4.6_1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libtool-2.4.6_1.sierra.bottle.tar.gz
==> Caveats
In order to prevent conflicts with Apple's own libtool we have prepended a "g"
so, you have instead: glibtool and glibtoolize.
==> Summary
ðŸº  /usr/local/Cellar/libtool/2.4.6_1: 70 files, 3.7MB
==> Installing php@7.2 dependency: unixodbc
==> Downloading https://homebrew.bintray.com/bottles/unixodbc-2.3.7.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring unixodbc-2.3.7.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/unixodbc/2.3.7: 46 files, 1.8MB
==> Installing php@7.2 dependency: freetds
==> Downloading https://homebrew.bintray.com/bottles/freetds-1.00.109.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring freetds-1.00.109.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/freetds/1.00.109: 2,098 files, 12.9MB
==> Installing php@7.2 dependency: libpng
==> Downloading https://homebrew.bintray.com/bottles/libpng-1.6.36.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libpng-1.6.36.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/libpng/1.6.36: 27 files, 1.2MB
==> Installing php@7.2 dependency: glib
==> Downloading https://homebrew.bintray.com/bottles/glib-2.58.3.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring glib-2.58.3.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/glib/2.58.3: 435 files, 18.5MB
==> Installing php@7.2 dependency: gmp
==> Downloading https://homebrew.bintray.com/bottles/gmp-6.1.2_2.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring gmp-6.1.2_2.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/gmp/6.1.2_2: 18 files, 3.1MB
==> Installing php@7.2 dependency: icu4c
==> Downloading https://homebrew.bintray.com/bottles/icu4c-63.1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring icu4c-63.1.sierra.bottle.tar.gz
==> Caveats
icu4c is keg-only, which means it was not symlinked into /usr/local,
because macOS provides libicucore.dylib (but nothing else).

If you need to have icu4c first in your PATH run:
  echo 'export PATH="/usr/local/opt/icu4c/bin:$PATH"' >> ~/.bash_profile
  echo 'export PATH="/usr/local/opt/icu4c/sbin:$PATH"' >> ~/.bash_profile

For compilers to find icu4c you may need to set:
  export LDFLAGS="-L/usr/local/opt/icu4c/lib"
  export CPPFLAGS="-I/usr/local/opt/icu4c/include"

For pkg-config to find icu4c you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/icu4c/lib/pkgconfig"

==> Summary
ðŸº  /usr/local/Cellar/icu4c/63.1: 254 files, 68.3MB
==> Installing php@7.2 dependency: jpeg
==> Downloading https://homebrew.bintray.com/bottles/jpeg-9c.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring jpeg-9c.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/jpeg/9c: 21 files, 724.6KB
==> Installing php@7.2 dependency: libpq
==> Downloading https://homebrew.bintray.com/bottles/libpq-11.1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libpq-11.1.sierra.bottle.tar.gz
==> Caveats
libpq is keg-only, which means it was not symlinked into /usr/local,
because conflicts with postgres formula.

If you need to have libpq first in your PATH run:
  echo 'export PATH="/usr/local/opt/libpq/bin:$PATH"' >> ~/.bash_profile

For compilers to find libpq you may need to set:
  export LDFLAGS="-L/usr/local/opt/libpq/lib"
  export CPPFLAGS="-I/usr/local/opt/libpq/include"

For pkg-config to find libpq you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/libpq/lib/pkgconfig"

==> Summary
ðŸº  /usr/local/Cellar/libpq/11.1: 2,567 files, 27.3MB
==> Installing php@7.2 dependency: libsodium
==> Downloading https://homebrew.bintray.com/bottles/libsodium-1.0.17.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libsodium-1.0.17.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/libsodium/1.0.17: 71 files, 985.7KB
==> Installing php@7.2 dependency: libzip
==> Downloading https://homebrew.bintray.com/bottles/libzip-1.5.1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring libzip-1.5.1.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/libzip/1.5.1: 134 files, 577.4KB
==> Installing php@7.2 dependency: readline
==> Downloading https://homebrew.bintray.com/bottles/readline-8.0.0.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring readline-8.0.0.sierra.bottle.tar.gz
==> Caveats
readline is keg-only, which means it was not symlinked into /usr/local,
because macOS provides the BSD libedit library, which shadows libreadline.
In order to prevent conflicts when programs look for libreadline we are
defaulting this GNU Readline installation to keg-only.

For compilers to find readline you may need to set:
  export LDFLAGS="-L/usr/local/opt/readline/lib"
  export CPPFLAGS="-I/usr/local/opt/readline/include"

For pkg-config to find readline you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/readline/lib/pkgconfig"

==> Summary
ðŸº  /usr/local/Cellar/readline/8.0.0: 48 files, 1.5MB
==> Installing php@7.2 dependency: sqlite
==> Downloading https://homebrew.bintray.com/bottles/sqlite-3.26.0_1.sierra.bottle.1.tar.gz
######################################################################## 100.0%
==> Pouring sqlite-3.26.0_1.sierra.bottle.1.tar.gz
==> Caveats
sqlite is keg-only, which means it was not symlinked into /usr/local,
because macOS provides an older sqlite3.

If you need to have sqlite first in your PATH run:
  echo 'export PATH="/usr/local/opt/sqlite/bin:$PATH"' >> ~/.bash_profile

For compilers to find sqlite you may need to set:
  export LDFLAGS="-L/usr/local/opt/sqlite/lib"
  export CPPFLAGS="-I/usr/local/opt/sqlite/include"

For pkg-config to find sqlite you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/sqlite/lib/pkgconfig"

==> Summary
ðŸº  /usr/local/Cellar/sqlite/3.26.0_1: 11 files, 3.7MB
==> Installing php@7.2 dependency: tidy-html5
==> Downloading https://homebrew.bintray.com/bottles/tidy-html5-5.6.0.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring tidy-html5-5.6.0.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/tidy-html5/5.6.0: 14 files, 2.6MB
==> Installing php@7.2 dependency: webp
==> Downloading https://homebrew.bintray.com/bottles/webp-1.0.2.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring webp-1.0.2.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/webp/1.0.2: 39 files, 2MB
==> Installing php@7.2
==> Downloading https://homebrew.bintray.com/bottles/php@7.2-7.2.14.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring php@7.2-7.2.14.sierra.bottle.tar.gz
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set php_ini /usr/local/etc/php/7.2/php.ini system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set php_dir /usr/local/share/pear@7.2 system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set doc_dir /usr/local/share/pear@7.2/doc system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set ext_dir /usr/local/lib/php/pecl/20170718 system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set bin_dir /usr/local/opt/php@7.2/bin system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set data_dir /usr/local/share/pear@7.2/data system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set cfg_dir /usr/local/share/pear@7.2/cfg system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set www_dir /usr/local/share/pear@7.2/htdocs system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set man_dir /usr/local/share/man system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set test_dir /usr/local/share/pear@7.2/test system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear config-set php_bin /usr/local/opt/php@7.2/bin/php system
==> /usr/local/Cellar/php@7.2/7.2.14/bin/pear update-channels
==> Caveats
To enable PHP in Apache add the following to httpd.conf and restart Apache:
    LoadModule php7_module /usr/local/opt/php@7.2/lib/httpd/modules/libphp7.so

    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>

Finally, check DirectoryIndex includes index.php
    DirectoryIndex index.php index.html

The php.ini and php-fpm.ini file can be found in:
    /usr/local/etc/php/7.2/

php@7.2 is keg-only, which means it was not symlinked into /usr/local,
because this is an alternate version of another formula.

If you need to have php@7.2 first in your PATH run:
  echo 'export PATH="/usr/local/opt/php@7.2/bin:$PATH"' >> ~/.bash_profile
  echo 'export PATH="/usr/local/opt/php@7.2/sbin:$PATH"' >> ~/.bash_profile

For compilers to find php@7.2 you may need to set:
  export LDFLAGS="-L/usr/local/opt/php@7.2/lib"
  export CPPFLAGS="-I/usr/local/opt/php@7.2/include"


To have launchd start php@7.2 now and restart at login:
  brew services start php@7.2
Or, if you don't want/need a background service you can just run:
  php-fpm
==> Summary
ðŸº  /usr/local/Cellar/php@7.2/7.2.14: 514 files, 74.9MB
==> Caveats
==> autoconf
Emacs Lisp files have been installed to:
  /usr/local/share/emacs/site-lisp/autoconf
==> libidn
Emacs Lisp files have been installed to:
  /usr/local/share/emacs/site-lisp/libidn
==> openldap
openldap is keg-only, which means it was not symlinked into /usr/local,
because macOS already provides this software and installing another version in
parallel can cause all kinds of trouble.

If you need to have openldap first in your PATH run:
  echo 'export PATH="/usr/local/opt/openldap/bin:$PATH"' >> ~/.bash_profile
  echo 'export PATH="/usr/local/opt/openldap/sbin:$PATH"' >> ~/.bash_profile

For compilers to find openldap you may need to set:
  export LDFLAGS="-L/usr/local/opt/openldap/lib"
  export CPPFLAGS="-I/usr/local/opt/openldap/include"

==> curl-openssl
curl-openssl is keg-only, which means it was not symlinked into /usr/local,
because macOS already provides this software and installing another version in
parallel can cause all kinds of trouble.

If you need to have curl-openssl first in your PATH run:
  echo 'export PATH="/usr/local/opt/curl-openssl/bin:$PATH"' >> ~/.bash_profile

For compilers to find curl-openssl you may need to set:
  export LDFLAGS="-L/usr/local/opt/curl-openssl/lib"
  export CPPFLAGS="-I/usr/local/opt/curl-openssl/include"

For pkg-config to find curl-openssl you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/curl-openssl/lib/pkgconfig"

==> libtool
In order to prevent conflicts with Apple's own libtool we have prepended a "g"
so, you have instead: glibtool and glibtoolize.
==> icu4c
icu4c is keg-only, which means it was not symlinked into /usr/local,
because macOS provides libicucore.dylib (but nothing else).

If you need to have icu4c first in your PATH run:
  echo 'export PATH="/usr/local/opt/icu4c/bin:$PATH"' >> ~/.bash_profile
  echo 'export PATH="/usr/local/opt/icu4c/sbin:$PATH"' >> ~/.bash_profile

For compilers to find icu4c you may need to set:
  export LDFLAGS="-L/usr/local/opt/icu4c/lib"
  export CPPFLAGS="-I/usr/local/opt/icu4c/include"

For pkg-config to find icu4c you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/icu4c/lib/pkgconfig"

==> libpq
libpq is keg-only, which means it was not symlinked into /usr/local,
because conflicts with postgres formula.

If you need to have libpq first in your PATH run:
  echo 'export PATH="/usr/local/opt/libpq/bin:$PATH"' >> ~/.bash_profile

For compilers to find libpq you may need to set:
  export LDFLAGS="-L/usr/local/opt/libpq/lib"
  export CPPFLAGS="-I/usr/local/opt/libpq/include"

For pkg-config to find libpq you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/libpq/lib/pkgconfig"

==> readline
readline is keg-only, which means it was not symlinked into /usr/local,
because macOS provides the BSD libedit library, which shadows libreadline.
In order to prevent conflicts when programs look for libreadline we are
defaulting this GNU Readline installation to keg-only.

For compilers to find readline you may need to set:
  export LDFLAGS="-L/usr/local/opt/readline/lib"
  export CPPFLAGS="-I/usr/local/opt/readline/include"

For pkg-config to find readline you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/readline/lib/pkgconfig"

==> sqlite
sqlite is keg-only, which means it was not symlinked into /usr/local,
because macOS provides an older sqlite3.

If you need to have sqlite first in your PATH run:
  echo 'export PATH="/usr/local/opt/sqlite/bin:$PATH"' >> ~/.bash_profile

For compilers to find sqlite you may need to set:
  export LDFLAGS="-L/usr/local/opt/sqlite/lib"
  export CPPFLAGS="-I/usr/local/opt/sqlite/include"

For pkg-config to find sqlite you may need to set:
  export PKG_CONFIG_PATH="/usr/local/opt/sqlite/lib/pkgconfig"

==> php@7.2
To enable PHP in Apache add the following to httpd.conf and restart Apache:
    LoadModule php7_module /usr/local/opt/php@7.2/lib/httpd/modules/libphp7.so

    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>

Finally, check DirectoryIndex includes index.php
    DirectoryIndex index.php index.html

The php.ini and php-fpm.ini file can be found in:
    /usr/local/etc/php/7.2/

php@7.2 is keg-only, which means it was not symlinked into /usr/local,
because this is an alternate version of another formula.

If you need to have php@7.2 first in your PATH run:
  echo 'export PATH="/usr/local/opt/php@7.2/bin:$PATH"' >> ~/.bash_profile
  echo 'export PATH="/usr/local/opt/php@7.2/sbin:$PATH"' >> ~/.bash_profile

For compilers to find php@7.2 you may need to set:
  export LDFLAGS="-L/usr/local/opt/php@7.2/lib"
  export CPPFLAGS="-I/usr/local/opt/php@7.2/include"


To have launchd start php@7.2 now and restart at login:
  brew services start php@7.2
Or, if you don't want/need a background service you can just run:
  php-fpm

```



Ok.

### Configuring apache to work with php

```bash
apconf
```

```bash
LoadModule php7_module /usr/local/opt/php@7.2/lib/httpd/modules/libphp7.so

<FilesMatch \.php$>
    SetHandler application/x-httpd-php
</FilesMatch>

DirectoryIndex index.php index.html
```


### Add a host

```bash
aphost

# then...
<VirtualHost *:80>
    ServerAdmin admin@gmail.com
    DocumentRoot "/komin/jin_site_demo/www"
    ServerName jindemo
    SetEnv JIN_APP_PROFILE dev
    <Directory "/komin/jin_site_demo/www">
        AllowOverride All
        Require all granted   # This is required in this version of apache, otherwise get the Forbidden error...
    </Directory>
</VirtualHost>

```




Okay, let's add some more aliases (in .bash_profile):

```bash
alias pconf='open /usr/local/etc/php/7.2/php.ini'
alias pstart='brew services start php@7.2'
alias prestart='brew services restart php@7.2'
alias pstop='brew services stop php@7.2'
```


Don't ask me why, but it's not required to start php to get the website running.





Installing  phpmyadmin
----------------

Since phpmyadmin needs mysql, if we install phpmyadmin will it install mysql as a dependency?


Let's try:

```bash
brew search php 


$ brew install phpmyadmin
==> Installing dependencies for phpmyadmin: pcre2 and php
==> Installing phpmyadmin dependency: pcre2
==> Downloading https://homebrew.bintray.com/bottles/pcre2-10.32.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring pcre2-10.32.sierra.bottle.tar.gz
ðŸº  /usr/local/Cellar/pcre2/10.32: 224 files, 5.4MB
==> Installing phpmyadmin dependency: php
==> Downloading https://homebrew.bintray.com/bottles/php-7.3.1.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring php-7.3.1.sierra.bottle.tar.gz
Error: The `brew link` step did not complete successfully
The formula built, but is not symlinked into /usr/local
Could not symlink bin/php
Target /usr/local/bin/php
already exists. You may want to remove it:
  rm '/usr/local/bin/php'

To force the link and overwrite all conflicting files:
  brew link --overwrite php

To list all files that would be deleted:
  brew link --overwrite --dry-run php

Possible conflicting files are:
/usr/local/bin/php -> /Applications/MAMP/bin/php/php7.1.1/bin/php
/usr/local/lib/httpd/build/config.nice
/usr/local/lib/httpd/build/config_vars.mk
/usr/local/lib/httpd/build/instdso.sh
/usr/local/lib/httpd/build/library.mk
/usr/local/lib/httpd/build/ltlib.mk
/usr/local/lib/httpd/build/mkdir.sh
/usr/local/lib/httpd/build/program.mk
/usr/local/lib/httpd/build/rules.mk
/usr/local/lib/httpd/build/special.mk
/usr/local/lib/httpd/modules/httpd.exp
/usr/local/lib/httpd/modules/mod_access_compat.so
/usr/local/lib/httpd/modules/mod_actions.so
/usr/local/lib/httpd/modules/mod_alias.so
/usr/local/lib/httpd/modules/mod_allowmethods.so
/usr/local/lib/httpd/modules/mod_asis.so
/usr/local/lib/httpd/modules/mod_auth_basic.so
/usr/local/lib/httpd/modules/mod_auth_digest.so
/usr/local/lib/httpd/modules/mod_auth_form.so
/usr/local/lib/httpd/modules/mod_authn_anon.so
/usr/local/lib/httpd/modules/mod_authn_core.so
/usr/local/lib/httpd/modules/mod_authn_dbd.so
/usr/local/lib/httpd/modules/mod_authn_dbm.so
/usr/local/lib/httpd/modules/mod_authn_file.so
/usr/local/lib/httpd/modules/mod_authn_socache.so
/usr/local/lib/httpd/modules/mod_authnz_fcgi.so
/usr/local/lib/httpd/modules/mod_authz_core.so
/usr/local/lib/httpd/modules/mod_authz_dbd.so
/usr/local/lib/httpd/modules/mod_authz_dbm.so
/usr/local/lib/httpd/modules/mod_authz_groupfile.so
/usr/local/lib/httpd/modules/mod_authz_host.so
/usr/local/lib/httpd/modules/mod_authz_owner.so
/usr/local/lib/httpd/modules/mod_authz_user.so
/usr/local/lib/httpd/modules/mod_autoindex.so
/usr/local/lib/httpd/modules/mod_brotli.so
/usr/local/lib/httpd/modules/mod_buffer.so
/usr/local/lib/httpd/modules/mod_cache.so
/usr/local/lib/httpd/modules/mod_cache_disk.so
/usr/local/lib/httpd/modules/mod_cache_socache.so
/usr/local/lib/httpd/modules/mod_cgi.so
/usr/local/lib/httpd/modules/mod_cgid.so
/usr/local/lib/httpd/modules/mod_charset_lite.so
/usr/local/lib/httpd/modules/mod_data.so
/usr/local/lib/httpd/modules/mod_dav.so
/usr/local/lib/httpd/modules/mod_dav_fs.so
/usr/local/lib/httpd/modules/mod_dav_lock.so
/usr/local/lib/httpd/modules/mod_dbd.so
/usr/local/lib/httpd/modules/mod_deflate.so
/usr/local/lib/httpd/modules/mod_dialup.so
/usr/local/lib/httpd/modules/mod_dir.so
/usr/local/lib/httpd/modules/mod_dumpio.so
/usr/local/lib/httpd/modules/mod_echo.so
/usr/local/lib/httpd/modules/mod_env.so
/usr/local/lib/httpd/modules/mod_expires.so
/usr/local/lib/httpd/modules/mod_ext_filter.so
/usr/local/lib/httpd/modules/mod_file_cache.so
/usr/local/lib/httpd/modules/mod_filter.so
/usr/local/lib/httpd/modules/mod_headers.so
/usr/local/lib/httpd/modules/mod_heartbeat.so
/usr/local/lib/httpd/modules/mod_heartmonitor.so
/usr/local/lib/httpd/modules/mod_http2.so
/usr/local/lib/httpd/modules/mod_include.so
/usr/local/lib/httpd/modules/mod_info.so
/usr/local/lib/httpd/modules/mod_lbmethod_bybusyness.so
/usr/local/lib/httpd/modules/mod_lbmethod_byrequests.so
/usr/local/lib/httpd/modules/mod_lbmethod_bytraffic.so
/usr/local/lib/httpd/modules/mod_lbmethod_heartbeat.so
/usr/local/lib/httpd/modules/mod_log_config.so
/usr/local/lib/httpd/modules/mod_log_debug.so
/usr/local/lib/httpd/modules/mod_log_forensic.so
/usr/local/lib/httpd/modules/mod_logio.so
/usr/local/lib/httpd/modules/mod_macro.so
/usr/local/lib/httpd/modules/mod_md.so
/usr/local/lib/httpd/modules/mod_mime.so
/usr/local/lib/httpd/modules/mod_mime_magic.so
/usr/local/lib/httpd/modules/mod_mpm_event.so
/usr/local/lib/httpd/modules/mod_mpm_prefork.so
/usr/local/lib/httpd/modules/mod_mpm_worker.so
/usr/local/lib/httpd/modules/mod_negotiation.so
/usr/local/lib/httpd/modules/mod_proxy.so
/usr/local/lib/httpd/modules/mod_proxy_ajp.so
/usr/local/lib/httpd/modules/mod_proxy_balancer.so
/usr/local/lib/httpd/modules/mod_proxy_connect.so
/usr/local/lib/httpd/modules/mod_proxy_express.so
/usr/local/lib/httpd/modules/mod_proxy_fcgi.so
/usr/local/lib/httpd/modules/mod_proxy_fdpass.so
/usr/local/lib/httpd/modules/mod_proxy_ftp.so
/usr/local/lib/httpd/modules/mod_proxy_hcheck.so
/usr/local/lib/httpd/modules/mod_proxy_html.so
/usr/local/lib/httpd/modules/mod_proxy_http.so
/usr/local/lib/httpd/modules/mod_proxy_scgi.so
/usr/local/lib/httpd/modules/mod_proxy_uwsgi.so
/usr/local/lib/httpd/modules/mod_proxy_wstunnel.so
/usr/local/lib/httpd/modules/mod_ratelimit.so
/usr/local/lib/httpd/modules/mod_reflector.so
/usr/local/lib/httpd/modules/mod_remoteip.so
/usr/local/lib/httpd/modules/mod_reqtimeout.so
/usr/local/lib/httpd/modules/mod_request.so
/usr/local/lib/httpd/modules/mod_rewrite.so
/usr/local/lib/httpd/modules/mod_sed.so
/usr/local/lib/httpd/modules/mod_session.so
/usr/local/lib/httpd/modules/mod_session_cookie.so
/usr/local/lib/httpd/modules/mod_session_crypto.so
/usr/local/lib/httpd/modules/mod_session_dbd.so
/usr/local/lib/httpd/modules/mod_setenvif.so
/usr/local/lib/httpd/modules/mod_slotmem_plain.so
/usr/local/lib/httpd/modules/mod_slotmem_shm.so
/usr/local/lib/httpd/modules/mod_socache_dbm.so
/usr/local/lib/httpd/modules/mod_socache_memcache.so
/usr/local/lib/httpd/modules/mod_socache_shmcb.so
/usr/local/lib/httpd/modules/mod_speling.so
/usr/local/lib/httpd/modules/mod_ssl.so
/usr/local/lib/httpd/modules/mod_status.so
/usr/local/lib/httpd/modules/mod_substitute.so
/usr/local/lib/httpd/modules/mod_suexec.so
/usr/local/lib/httpd/modules/mod_unique_id.so
/usr/local/lib/httpd/modules/mod_unixd.so
/usr/local/lib/httpd/modules/mod_userdir.so
/usr/local/lib/httpd/modules/mod_usertrack.so
/usr/local/lib/httpd/modules/mod_version.so
/usr/local/lib/httpd/modules/mod_vhost_alias.so
/usr/local/lib/httpd/modules/mod_watchdog.so
/usr/local/lib/httpd/modules/mod_xml2enc.so
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set php_ini /usr/local/etc/php/7.3/php.ini system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set php_dir /usr/local/share/pear system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set doc_dir /usr/local/share/pear/doc system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set ext_dir /usr/local/lib/php/pecl/20180731 system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set bin_dir /usr/local/opt/php/bin system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set data_dir /usr/local/share/pear/data system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set cfg_dir /usr/local/share/pear/cfg system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set www_dir /usr/local/share/pear/htdocs system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set man_dir /usr/local/share/man system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set test_dir /usr/local/share/pear/test system
==> /usr/local/Cellar/php/7.3.1/bin/pear config-set php_bin /usr/local/opt/php/bin/php system
==> /usr/local/Cellar/php/7.3.1/bin/pear update-channels
==> Caveats
To enable PHP in Apache add the following to httpd.conf and restart Apache:
    LoadModule php7_module /usr/local/opt/php/lib/httpd/modules/libphp7.so

    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>

Finally, check DirectoryIndex includes index.php
    DirectoryIndex index.php index.html

The php.ini and php-fpm.ini file can be found in:
    /usr/local/etc/php/7.3/

To have launchd start php now and restart at login:
  brew services start php
Or, if you don't want/need a background service you can just run:
  php-fpm
==> Summary
ðŸº  /usr/local/Cellar/php/7.3.1: 521 files, 76.4MB
==> Installing phpmyadmin
==> Downloading https://files.phpmyadmin.net/phpMyAdmin/4.8.5/phpMyAdmin-4.8.5-all-languages.tar.gz
######################################################################## 100.0%
==> Caveats
To enable phpMyAdmin in Apache, add the following to httpd.conf and
restart Apache:
    Alias /phpmyadmin /usr/local/share/phpmyadmin
    <Directory /usr/local/share/phpmyadmin/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        <IfModule mod_authz_core.c>
            Require all granted
        </IfModule>
        <IfModule !mod_authz_core.c>
            Order allow,deny
            Allow from all
        </IfModule>
    </Directory>
Then open http://localhost/phpmyadmin
The configuration file is /usr/local/etc/phpmyadmin.config.inc.php
==> Summary
ðŸº  /usr/local/Cellar/phpmyadmin/4.8.5: 2,438 files, 32.3MB, built in 13 seconds
==> Caveats
==> php
To enable PHP in Apache add the following to httpd.conf and restart Apache:
    LoadModule php7_module /usr/local/opt/php/lib/httpd/modules/libphp7.so

    <FilesMatch \.php$>
        SetHandler application/x-httpd-php
    </FilesMatch>

Finally, check DirectoryIndex includes index.php
    DirectoryIndex index.php index.html

The php.ini and php-fpm.ini file can be found in:
    /usr/local/etc/php/7.3/

To have launchd start php now and restart at login:
  brew services start php
Or, if you don't want/need a background service you can just run:
  php-fpm
==> phpmyadmin
To enable phpMyAdmin in Apache, add the following to httpd.conf and
restart Apache:
    Alias /phpmyadmin /usr/local/share/phpmyadmin
    <Directory /usr/local/share/phpmyadmin/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        <IfModule mod_authz_core.c>
            Require all granted
        </IfModule>
        <IfModule !mod_authz_core.c>
            Order allow,deny
            Allow from all
        </IfModule>
    </Directory>
Then open http://localhost/phpmyadmin
The configuration file is /usr/local/etc/phpmyadmin.config.inc.php
```




Oops, looks like it didn't install mysql, but installed php 7.3 (what the heck?).
Let's just ignore this for now.



### Configure apache to work with phpmyadmin

```bash
apconf

# ...
Alias /phpmyadmin /usr/local/share/phpmyadmin
<Directory /usr/local/share/phpmyadmin/>
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Allow from all
    </IfModule>
</Directory>
```

Then restart apache

```bash
aprestart
```

Then open http://localhost/phpmyadmin

The configuration file is /usr/local/etc/phpmyadmin.config.inc.php





Installing mysql
----------------


```bash
brew search mysql 
$ brew install mysql
==> Downloading https://homebrew.bintray.com/bottles/mysql-8.0.13.sierra.bottle.tar.gz
######################################################################## 100.0%
==> Pouring mysql-8.0.13.sierra.bottle.tar.gz
==> /usr/local/Cellar/mysql/8.0.13/bin/mysqld --initialize-insecure --user=pierrelafitte --basedir=/usr/local/Cellar/mysql/8.0.13 --datadir=/usr/local/var/mysql --tmpdir=/tmp
==> Caveats
We've installed your MySQL database without a root password. To secure it run:
    mysql_secure_installation

MySQL is configured to only allow connections from localhost by default

To connect run:
    mysql -uroot

To have launchd start mysql now and restart at login:
  brew services start mysql
Or, if you don't want/need a background service you can just run:
  mysql.server start
==> Summary
ðŸº  /usr/local/Cellar/mysql/8.0.13: 267 files, 237.4MB

```

Start mysql service:

```bash
brew services start mysql
```


Secure the installation (set a root password):

```bash
$ mysql_secure_installation

Securing the MySQL server deployment.

Connecting to MySQL using a blank password.

VALIDATE PASSWORD COMPONENT can be used to test passwords
and improve security. It checks the strength of password
and allows the users to set only those passwords which are
secure enough. Would you like to setup VALIDATE PASSWORD component?

Press y|Y for Yes, any other key for No: 
Please set the password for root here.

New password: 

Re-enter new password: 
By default, a MySQL installation has an anonymous user,
allowing anyone to log into MySQL without having to have
a user account created for them. This is intended only for
testing, and to make the installation go a bit smoother.
You should remove them before moving into a production
environment.

Remove anonymous users? (Press y|Y for Yes, any other key for No) : 

 ... skipping.


Normally, root should only be allowed to connect from
'localhost'. This ensures that someone cannot guess at
the root password from the network.

Disallow root login remotely? (Press y|Y for Yes, any other key for No) : 

 ... skipping.
By default, MySQL comes with a database named 'test' that
anyone can access. This is also intended only for testing,
and should be removed before moving into a production
environment.


Remove test database and access to it? (Press y|Y for Yes, any other key for No) : 

 ... skipping.
Reloading the privilege tables will ensure that all changes
made so far will take effect immediately.

Reload privilege tables now? (Press y|Y for Yes, any other key for No) : y
Success.

All done! 

```



Let's add some aliases:

```bash
alias mstart='brew services start mysql'
alias mrestart='brew services restart mysql'
alias mstop='brew services stop mysql'
```



But I still have two problems:

- from my php app:
	SQLSTATE[HY000] [2054] The server requested authentication method unknown to the client

- phpmyadmin login panel:
	 Cannot log in to the MySQL server
	 mysqli_real_connect(): The server requested authentication method unknown to the client [caching_sha2_password]
	 mysqli_real_connect(): (HY000/2054): The server requested authentication method unknown to the client




Ok, first what's the mysql version:

```bash
mysql -uroot -proot	 
mysql: [Warning] Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 9
Server version: 8.0.13 Homebrew

Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> 
```

So version 8.

The problem with php seems to be resolved by this:

https://stackoverflow.com/questions/52364415/the-server-requested-authentication-method-unknown-to-the-client-php
```bash
open ~/my.cnf

# then add
[mysqld]
default_authentication_plugin= mysql_native_password

```

But then the php app gives me this error:

- SQLSTATE[HY000] [2002] No such file or directory


Ok, what's the php version by the way?

```php
// in my php script
phpinfo(); // Version 7.2.14
```


Ok, back to the problem, this guy seems to have a solution:
https://stackoverflow.com/questions/20723803/pdoexception-sqlstatehy000-2002-no-such-file-or-directory

```bash
php -i | grep pdo
Configure Command =>  './configure'  '--with-gd' '--with-jpeg-dir=/Applications/MAMP/Library' '--with-png-dir=/Applications/MAMP/Library' '--with-zlib' '--with-zlib-dir=/Applications/MAMP/Library' '--with-freetype-dir=/Applications/MAMP/Library' '--prefix=/Applications/MAMP/bin/php/php7.1.1' '--exec-prefix=/Applications/MAMP/bin/php/php7.1.1' '--sysconfdir=/Applications/MAMP/bin/php/php7.1.1/conf' '--with-config-file-path=/Applications/MAMP/bin/php/php7.1.1/conf' '--enable-ftp' '--enable-gd-native-ttf' '--with-bz2=/Applications/MAMP/Library' '--with-ldap' '--with-mysqli=mysqlnd' '--enable-mbstring=all' '--with-curl=/Applications/MAMP/Library' '--enable-sockets' '--enable-bcmath' '--with-imap=shared,/Applications/MAMP/Library/lib/imap-2007f' '--with-imap-ssl=/Applications/MAMP/Library' '--enable-soap' '--with-kerberos' '--enable-calendar' '--with-pgsql=shared,/Applications/MAMP/Library/pg' '--enable-exif' '--with-libxml-dir=/Applications/MAMP/Library' '--with-gettext=shared,/Applications/MAMP/Library' '--with-xsl=/Applications/MAMP/Library' '--with-pdo-mysql=mysqlnd' '--with-pdo-pgsql=shared,/Applications/MAMP/Library/pg' '--with-mcrypt=shared,/Applications/MAMP/Library' '--with-openssl=/Applications/MAMP/Library' '--enable-zip' '--with-iconv=/Applications/MAMP/Library' '--enable-opcache' '--enable-cgi' '--enable-intl' '--with-tidy=shared' '--with-icu-dir=/Applications/MAMP/Library' '--enable-wddx' '--with-libexpat-dir=/Applications/MAMP/Library' '--with-readline' '--with-mhash' 'YACC=/Applications/MAMP/Library/bin/bison'
API Extensions => pdo_mysql,mysqli
pdo_mysql
pdo_mysql.default_socket => /Applications/MAMP/tmp/mysql/mysql.sock => /Applications/MAMP/tmp/mysql/mysql.sock
pdo_pgsql
pdo_sqlite
```

Seems that Mamp is still in memory.


Let's see what mysql says about that:

```bash
mysql_config --socket
/tmp/mysql.sock
```

Aha, so mysql uses /tmp/mysql.sock.
Let's configure php.


```bash
pconf 
# and then...
pdo_mysql.default_socket=/tmp/mysql.sock
```

Then restart apache (still no use for php via brew services so far...)

```bash
aprestart
```


And, this error message again:

```txt
SQLSTATE[HY000] [2054] The server requested authentication method unknown to the client
```

https://github.com/laradock/laradock/issues/1390

```bash
mysql -uroot -proot


mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
4 rows in set (0.01 sec)



mysql> use mysql;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+---------------------------+
| Tables_in_mysql           |
+---------------------------+
| columns_priv              |
| component                 |
| db                        |
| default_roles             |
| engine_cost               |
| func                      |
| general_log               |
| global_grants             |
| gtid_executed             |
| help_category             |
| help_keyword              |
| help_relation             |
| help_topic                |
| innodb_index_stats        |
| innodb_table_stats        |
| password_history          |
| plugin                    |
| procs_priv                |
| proxies_priv              |
| role_edges                |
| server_cost               |
| servers                   |
| slave_master_info         |
| slave_relay_log_info      |
| slave_worker_info         |
| slow_log                  |
| tables_priv               |
| time_zone                 |
| time_zone_leap_second     |
| time_zone_name            |
| time_zone_transition      |
| time_zone_transition_type |
| user                      |
+---------------------------+
33 rows in set (0.00 sec)



mysql> select Host, User, authentication_string from user;
+-----------+------------------+------------------------------------------------------------------------+
| Host      | User             | authentication_string                                                  |
+-----------+------------------+------------------------------------------------------------------------+
| localhost | mysql.infoschema | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED |
| localhost | mysql.session    | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED |
| localhost | mysql.sys        | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED |
| localhost | root             | $A$005$i~2VTh!1,s\JX3ldyNvRF8.H3pbeCaJbVlt8tRGQlEECvKIOKGpc1T6L8 |
+-----------+------------------+------------------------------------------------------------------------+
4 rows in set (0.00 sec)

mysql> alter user 'root'@'localhost' identified with mysql_native_password by 'root';
Query OK, 0 rows affected (0.26 sec)

mysql> select Host, User, authentication_string from user;
+-----------+------------------+------------------------------------------------------------------------+
| Host      | User             | authentication_string                                                  |
+-----------+------------------+------------------------------------------------------------------------+
| localhost | mysql.infoschema | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED |
| localhost | mysql.session    | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED |
| localhost | mysql.sys        | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED |
| localhost | root             | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B                              |
+-----------+------------------+------------------------------------------------------------------------+
4 rows in set (0.00 sec)


```


And then my app says:

```html
SQLSTATE[HY000] [1049] Unknown database 'kit'
```

Which means the problem was solved, but I lost my databases in the process.
I suppose they are in the Mamp directory somewhere.



So, finally, the amp stack is working, and I will try sqlite.












